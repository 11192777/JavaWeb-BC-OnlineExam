<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pers.sdd.online.exam.dao.JudeTopicDao">
	
	
	<!-- void insertJudeTopic(JudeTopicBean topicBean); -->
	<insert id="insertJudeTopic">
		INSERT INTO t_topic_judge (
			top_content,
			result,
			maj_name,
			cou_id
		)
		VALUE
		(#{topContent}, #{result}, #{majName}, #{couId})
	</insert>
	
	<!-- void deleteTopicById(Integer topicId); -->
	<delete id="deleteTopicById">
		DELETE 
		FROM
			t_topic_judge
		WHERE
			top_id = #{topicId}
	</delete>
	
	<!-- void updateIncrementId(); -->
	<update id="updateIncrementId">
		UPDATE t_topic_judge AS t1
		JOIN (
			SELECT
				top_id,
				(@rowno :=@rowno + 1) AS rowno
			FROM
				t_topic_judge a,
				(SELECT(@rowno := 0)) b
			ORDER BY
				a.top_id
		) AS t2
		SET t1.top_id = t2.rowno
		WHERE
			t1.top_id = t2.top_id;
	</update>
	
	<!-- void alterAutoIncrementId(Integer i); -->
	<update id="alterAutoIncrementId">
		ALTER TABLE t_topic_judge AUTO_INCREMENT = #{i};
	</update>
	
	<!-- JudeTopicBean queryTopicById(Integer topicId); -->
	<select id="queryTopicById" resultType="pers.sdd.online.exam.bean.JudeTopicBean">
		SELECT
			*
		FROM
			t_topic_judge
		WHERE
			top_id = #{topicId}
	</select>
	
	<!-- Integer queryCourseTotal(); -->
	<select id="queryCourseTotal" resultType="java.lang.Integer">
		SELECT
			count(*)
		FROM
			t_topic_judge
	</select>
	
	<!-- List<JudeTopicBean> queryTopicList(String majorName, Integer courseId); -->
	<select id="queryTopicList" resultType="pers.sdd.online.exam.bean.JudeTopicBean">
		SELECT 
	 		*
	 	FROM
	 		t_topic_judge
	 	<where>
		 	<if test="param1 != ''">
		 		AND maj_name = #{param1}
		 	</if>
	 		<if test="param2 != null">
	 			AND cou_id = #{param2}
	 		</if>
	 	</where>
	</select>
	
</mapper>